//written by prashant singh
//on 05-10-2018
//code-coverage:-81%
//class name:-HL_Perfios_CallingAPI
@istest
public class Test_HL_Perfios_CallingAPI {

    @testsetup
    public static void setupMethod()
        
    {	
         KVB_Company_Details__c kvb = new KVB_Company_Details__c();
		kvb.KVB_MW_Base_URL__c = 'https://www.kvbbank.net';
        kvb.GST__c = 18;
        insert kvb;       
       
        
        KVB_Endpoint_URLs__c kvb1 = new KVB_Endpoint_URLs__c();
     	KVB1.Name = 'Apigee_Access_Token';
        KVB1.Endpoint_URL__c = 'https://kvb-test.apigee.net/next/v1/oauth/cc/accesstoken';
        kvb1.Username__c='prashant singh';
     	insert kvb1;
        KVB_Endpoint_URLs__c kvb2 = new KVB_Endpoint_URLs__c();
     	KVB2.Name = 'Perfios_Report';
        KVB2.Endpoint_URL__c = 'https://kvb-test.apigee.net/next/v1/analysis/report?reportFormat=json&txnId=12121';
     	insert kvb2;
         KVB_Endpoint_URLs__c kvb3 = new KVB_Endpoint_URLs__c();
     	KVB3.Name = 'Perfios_Status';
        KVB3.Endpoint_URL__c = 'https://kvb-test.apigee.net/next/v1/analysis/status?txnId=';
     	insert kvb3;
        Id RecordTypeIdclPerson = Schema.SObjectType.Account.getRecordTypeInfosByName().get('Person Account').getRecordTypeId();
         //genesis__applications__c app = TestUtility.intialSetUp('Personal Loan', true);
          Account acc = new Account();
         acc.LastName = 'Ashish';
         acc.Full_Name__c = 'Ashish G Jain';
         acc.PersonEmail = 'qulity@data.com';
         acc.PersonMobilePhone = '2335232345'; 
         acc.RecordTypeID = RecordTypeIdclPerson;
         insert acc; 
                Id recordidapp = Schema.SObjectType.genesis__Applications__c.getRecordTypeInfosByName().get(Constants.LAPLOAN).getRecordTypeId();

        genesis__Applications__c newApp = new genesis__Applications__c();
        newApp.genesis__Loan_Amount__c = 100000;
        newApp.genesis__Term__c =12;
        newApp.genesis__Amortization_Term__c = 12;
        newApp.genesis__Loan_Number__c = 'TS123'; 
        newApp.genesis__Interest_Rate__c = 15;
        newApp.genesis__Payment_Frequency__c = 'Monthly';
        newApp.genesis__Account__c =acc.id;
        //newApp.genesis__CL_Product__c = product.id;
        newApp.Sub_Stage__c = 'Disbursement Rejected';
        newApp.Branch_City__c = '1858';
        newApp.branch_Code__c = '1858';
        newApp.Flags_Raised__c=false;
        newApp.Charges_Processed__c=true;  
         newApp.RecordTypeId=recordidapp; 
        INSERT newApp;
        
          Perfios__c perf = new Perfios__c();
        perf.Applicant_Name__c = acc.id;
         perf.Active__c=true;
         perf.Application__c=newApp.id;
         perf.Bank_Account_Number__c='1185156000000445';
        INSERT perf;
         genesis__Application_Parties__c party =new genesis__Application_Parties__c();
            
            party.Key_Contact__c = acc.id;
            party.genesis__Party_Account_Name__c=acc.id;
            party.genesis__Party_Type__c = Constants.Co_Borrower;
            party.Active__c = true;
        party.Company__c=false;
        party.genesis__Application__c=newApp.id;
            insert party;
    }
    
 
    //Bank_Account_Number__c matched 
        public static testMethod void method1(){
             //PerfiosReportResponseHL temp=new PerfiosReportResponseHL();
            // string json='{ "customerInfo": { "name": "NALINA KRISHNAN S", "address": "123ede", "landline": "1234321", "mobile": "123454322", "email": "prashantsingh@gmail.com", "pan": "873hu38h39", "perfiosTransactionId": "KYX41538656269736", "customerTransactionId": "cac5d4f1-6d25-0384-ea68-d2880f545507", "bank": "Karur Vysya Bank, India", "instId": 50 }, "combinedMonthlyDetails": [ { "monthName": "Oct-17", "startDate": "2017-10-01" }, { "monthName": "Nov-17", "startDate": "2017-11-01" }, { "monthName": "Dec-17", "startDate": "2017-12-01" }, { "monthName": "Jan-18", "startDate": "2018-01-01" }, { "monthName": "Feb-18", "startDate": "2018-02-01" }, { "monthName": "Mar-18", "startDate": "2018-03-01" }, { "monthName": "Apr-18", "startDate": "2018-04-01" }, { "monthName": "May-18", "startDate": "2018-05-01" }, { "monthName": "Jun-18", "startDate": "2018-06-01" }, { "monthName": "Jul-18", "startDate": "2018-07-01" }, { "monthName": "Aug-18", "startDate": "2018-08-01" }, { "monthName": "Sep-18", "startDate": "2018-09-01" } ], "accountXns": [], "customUserInfo": {}, "AdditionalMonthlyDetails": [], "AdditionalSummaryDetails": { "avgBalanceOf3Months": 28109.21, "avgBalanceOf6Months": 30115.02, "avgBalanceOf12Months": 25692.19, "avgCreditsOf6Months": 9.17, "avgDebitsOf6Months": 27.17, "avgTotalCreditOf6Months": 114216.61, "avgTotalDebitOf6Months": 111812.62, "avgBalanceOf6MonthsToEMI": 30.12, "salaryContinuous": "Yes" }, "AdditionalForm26ASInfo": {}, "summaryInfo": { "instName": "Karur Vysya Bank, India", "accNo": [ { "bankAccNo": "1185156000000445" } ], "accType": "C", "fullMonthCount": 12, "total": { "bal15": 263119.09, "bal25": 139295.99, "bal5": 388491.59, "balAvg": 308306.23, "balLast": 438254.98, "balOpen": 431767.01, "credits": 109, "debits": 305, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "outwBounces": 0, "outwECSBounces": 0, "salaries": 12, "stopPayments": 0, "totalCredit": 1283008.68, "totalDebit": 1276520.71, "totalEmiIssue": 0, "totalInvIncome": 1324, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 476434.99, "totalTransferOut": 264160 }, "average": { "bal15": 21926.59, "bal25": 11608, "bal5": 32374.3, "balAvg": 25692.19, "balLast": 36521.25, "balOpen": 35980.58, "credits": 9, "debits": 25, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "stopPayments": 0, "totalCredit": 106917.39, "totalDebit": 106376.73, "totalEmiIssue": 0, "totalInvIncome": 110.33, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 39702.92, "totalTransferOut": 22013.33 }, "primaryAccNo": "1185156000000445" }, "monthlyDetails": [ { "bal15": 28226.87, "bal25": 19374.87, "bal5": 12588.87, "balAvg": 24290.46, "balLast": 37471.19, "balOpen": 27187.77, "credits": 9, "debits": 24, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Oct-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-10-01", "stopPayments": 0, "totalCredit": 79055.42, "totalDebit": 68772, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 42096.32, "totalTransferOut": 852 }, { "bal15": 18193.19, "bal25": 7413.19, "bal5": 30171.19, "balAvg": 22843.8, "balLast": 31651.93, "balOpen": 37471.19, "credits": 7, "debits": 23, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Nov-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-11-01", "stopPayments": 0, "totalCredit": 270438.74, "totalDebit": 276258, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 39238.74, "totalTransferOut": 25308 }, { "bal15": 10105.93, "bal25": 2455, "bal5": 25301.93, "balAvg": 15329.64, "balLast": 29305.74, "balOpen": 31651.93, "credits": 8, "debits": 22, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Dec-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-12-01", "stopPayments": 0, "totalCredit": 49115.81, "totalDebit": 51462, "totalEmiIssue": 0, "totalInvIncome": 265, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 38585.74, "totalTransferOut": 1216 }, { "bal15": 43428.43, "bal25": 26375.43, "bal5": 52739.43, "balAvg": 35229.09, "balLast": 22470.17, "balOpen": 29305.74, "credits": 16, "debits": 32, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jan-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-01-01", "stopPayments": 0, "totalCredit": 84361.43, "totalDebit": 91197, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 38797.74, "totalTransferOut": 22059 }, { "bal15": 10920.17, "bal25": 920.17, "bal5": 10470.17, "balAvg": 9391.1, "balLast": 6645.54, "balOpen": 22470.17, "credits": 3, "debits": 17, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Feb-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-02-01", "stopPayments": 0, "totalCredit": 22725.37, "totalDebit": 38550, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 15725.37, "totalTransferOut": 0 }, { "bal15": 29546.54, "bal25": 0.54, "bal5": 30956.54, "balAvg": 20532.05, "balLast": 19251.81, "balOpen": 6645.54, "credits": 11, "debits": 24, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Mar-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-03-01", "stopPayments": 0, "totalCredit": 92012.27, "totalDebit": 79406, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 36254.37, "totalTransferOut": 6240 }, { "bal15": 60425.81, "bal25": 23314.81, "bal5": 8545.81, "balAvg": 37198.47, "balLast": 66370.18, "balOpen": 19251.81, "credits": 7, "debits": 19, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Apr-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-04-01", "stopPayments": 0, "totalCredit": 111876.37, "totalDebit": 64758, "totalEmiIssue": 0, "totalInvIncome": 294, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 49405.37, "totalTransferOut": 30350 }, { "bal15": 7545.47, "bal25": 7561.47, "bal5": 56365.47, "balAvg": 29281.83, "balLast": 82822.86, "balOpen": 66370.18, "credits": 8, "debits": 30, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "May-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-05-01", "stopPayments": 0, "totalCredit": 109409.39, "totalDebit": 92956.71, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 44504.39, "totalTransferOut": 13449 }, { "bal15": 19329.86, "bal25": 265.61, "bal5": 64422.86, "balAvg": 29882.16, "balLast": 30618.98, "balOpen": 82822.86, "credits": 6, "debits": 35, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jun-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-06-01", "stopPayments": 0, "totalCredit": 52747.12, "totalDebit": 104951, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 43393.37, "totalTransferOut": 23486 }, { "bal15": 15086.48, "bal25": 15386.48, "bal5": 16096.98, "balAvg": 28507.99, "balLast": 41132.87, "balOpen": 30618.98, "credits": 5, "debits": 28, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jul-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-07-01", "stopPayments": 0, "totalCredit": 231833.89, "totalDebit": 221320, "totalEmiIssue": 0, "totalInvIncome": 408, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 41866.39, "totalTransferOut": 137800 }, { "bal15": 9142.37, "bal25": 34120.45, "bal5": 58644.37, "balAvg": 38710.45, "balLast": 36837.97, "balOpen": 41132.87, "credits": 24, "debits": 27, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Aug-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-08-01", "stopPayments": 0, "totalCredit": 134475.1, "totalDebit": 138770, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 42717.52, "totalTransferOut": 3400 }, { "bal15": 11167.97, "bal25": 2107.97, "bal5": 22187.97, "balAvg": 17109.2, "balLast": 33675.74, "balOpen": 36837.97, "credits": 5, "debits": 24, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Sep-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-09-01", "stopPayments": 0, "totalCredit": 44957.77, "totalDebit": 48120, "totalEmiIssue": 0, "totalInvIncome": 357, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 43849.67, "totalTransferOut": 0 } ], "regularCredits": [ { "regularChangeDate": "2017-10-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Oct 2017 Salary 005360", "amount": 42096.32, "category": "Salary", "balance": 61471.19 }, { "regularChangeDate": "2017-11-28", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Nov 2017 Salary 005360", "amount": 39238.74, "category": "Salary", "balance": 46651.93 }, { "regularChangeDate": "2017-12-28", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Dec 2017 Salary 005360", "amount": 38585.74, "category": "Salary", "balance": 41040.74 }, { "regularChangeDate": "2018-01-29", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Jan 2018 Salary 005360", "amount": 38797.74, "category": "Salary", "balance": 45185.17 }, { "regularChangeDate": "2018-02-26", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Feb 2018 Salary 005360", "amount": 15725.37, "category": "Salary", "balance": 16645.54 }, { "regularChangeDate": "2018-03-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Mar 2018 Salary 005360", "amount": 36254.37, "category": "Salary", "balance": 36254.91 }, { "regularChangeDate": "2018-04-26", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Apr 2018 Salary 005360", "amount": 49405.37, "category": "Salary", "balance": 72720.18 }, { "regularChangeDate": "2018-05-29", "regularChangeGroup": 1, "chqNo": "", "narration": "NT May 2018 Salary 005360", "amount": 44504.39, "category": "Salary", "balance": 81129.86 }, { "regularChangeDate": "2018-06-28", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Jun 2018 Salary 005360", "amount": 43393.37, "category": "Salary", "balance": 43658.98 }, { "regularChangeDate": "2018-07-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Jul 2018 Salary 005360", "amount": 41866.39, "category": "Salary", "balance": 57252.87 }, { "regularChangeDate": "2018-08-29", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Aug 2018 Salary 005360", "amount": 42717.52, "category": "Salary", "balance": 76837.97 }, { "regularChangeDate": "2018-09-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Sep 2018 Salary 005360", "amount": 43849.67, "category": "Salary", "balance": 45957.64 } ], "eODBalances": [], "highValueDebitXns": [], "highValueCreditXns": [] }';      
           
            String json='{ "customerInfo": { "name": "PRITAM PIYUSH BHOWMIK", "address": "25 KALPATARU APARTMENTS, RAMKRISHNA NAGAR NAGPUR CITY, BEHIND UNION BANK PRATAP NAGAR, NAGPUR, MAHARASHTRA, 440025, INDIA", "landline": "07122287515", "mobile": "XXXXX71419", "email": "PRITAM388@GMAIL.COM", "pan": "BCGPB4258L", "perfiosTransactionId": "JHH81543232886849", "customerTransactionId": "3c5d6d68-c646-d893-9d9f-7bc8a1303448", "bank": "HDFC Bank, India", "instId": 20 }, "combinedMonthlyDetails": [ { "monthName": "Nov-17", "startDate": "2017-11-01" }, { "monthName": "Dec-17", "startDate": "2017-12-01" }, { "monthName": "Jan-18", "startDate": "2018-01-01" }, { "monthName": "Feb-18", "startDate": "2018-02-01" }, { "monthName": "Mar-18", "startDate": "2018-03-01" }, { "monthName": "Apr-18", "startDate": "2018-04-01" }, { "monthName": "May-18", "startDate": "2018-05-01" }, { "monthName": "Jun-18", "startDate": "2018-06-01" }, { "monthName": "Jul-18", "startDate": "2018-07-01" }, { "monthName": "Aug-18", "startDate": "2018-08-01" }, { "monthName": "Sep-18", "startDate": "2018-09-01" }, { "monthName": "Oct-18", "startDate": "2018-10-01" } ], "accountXns": [], "customUserInfo": {}, "AdditionalMonthlyDetails": [], "AdditionalSummaryDetails": { "facility": "NONE", "avgBalanceOf3Months": 18963.03, "avgBalanceOf6Months": 16853.14, "avgBalanceOf12Months": 18056.53, "avgCreditsOf6Months": 15.67, "avgDebitsOf6Months": 68.67, "avgTotalCreditOf6Months": 112764.74, "avgTotalDebitOf6Months": 111910.31, "avgBalanceOf6MonthsToEMI": 16.85, "salaryContinuous": "Yes" }, "AdditionalForm26ASInfo": {}, "summaryInfo": { "instName": "HDFC Bank, India", "accNo": [ { "bankAccNo": "50100014916725" } ], "accType": "Savings", "fullMonthCount": 12, "total": { "bal15": 182728.05, "bal25": 89360.17, "bal5": 610509.04, "balAvg": 216678.31, "balLast": 68201.56, "balOpen": 85722.66, "credits": 203, "debits": 681, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "outwBounces": 0, "outwECSBounces": 0, "salaries": 12, "stopPayments": 0, "totalCredit": 1325346.44, "totalDebit": 1348061.17, "totalEmiIssue": 0, "totalInvIncome": 1736, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 942263, "totalTransferOut": 626869.07 }, "average": { "bal15": 15227.34, "bal25": 7446.68, "bal5": 50875.75, "balAvg": 18056.53, "balLast": 5683.46, "balOpen": 7143.56, "credits": 17, "debits": 57, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "stopPayments": 0, "totalCredit": 110445.54, "totalDebit": 112338.43, "totalEmiIssue": 0, "totalInvIncome": 144.67, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 78521.92, "totalTransferOut": 52239.09 }, "primaryAccNo": "50100014916725" }, "monthlyDetails": [ { "bal15": 10536.17, "bal25": 3390.56, "bal5": 34773.17, "balAvg": 16109.6, "balLast": 724.56, "balOpen": 26492.17, "credits": 25, "debits": 46, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Nov-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-11-01", "stopPayments": 0, "totalCredit": 127851, "totalDebit": 153618.61, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 64485, "totalTransferOut": 76996.61 }, { "bal15": 10228, "bal25": 5182.23, "bal5": 65631.75, "balAvg": 12912.73, "balLast": 4378.23, "balOpen": 724.56, "credits": 13, "debits": 36, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Dec-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-12-01", "stopPayments": 0, "totalCredit": 85223, "totalDebit": 83724.33, "totalEmiIssue": 0, "totalInvIncome": 182, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 64910, "totalTransferOut": 41572.43 }, { "bal15": 14119.23, "bal25": 4330.98, "bal5": 44567.23, "balAvg": 15502.95, "balLast": 2150.6, "balOpen": 4378.23, "credits": 8, "debits": 48, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jan-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-01-01", "stopPayments": 0, "totalCredit": 124531, "totalDebit": 126762.38, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 69739, "totalTransferOut": 60733 }, { "bal15": 16499.6, "bal25": 5245.7, "bal5": 48983.6, "balAvg": 25675.92, "balLast": 1251.7, "balOpen": 2150.6, "credits": 15, "debits": 54, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Feb-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-02-01", "stopPayments": 0, "totalCredit": 108285, "totalDebit": 109183.9, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 72151, "totalTransferOut": 50949.3 }, { "bal15": 25441.7, "bal25": 19635.2, "bal5": 57231.7, "balAvg": 26903.37, "balLast": 14688.2, "balOpen": 1251.7, "credits": 37, "debits": 38, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Mar-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-03-01", "stopPayments": 0, "totalCredit": 100100, "totalDebit": 86663.5, "totalEmiIssue": 0, "totalInvIncome": 619, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 75617, "totalTransferOut": 30233.08 }, { "bal15": 8367.36, "bal25": 1151.61, "bal5": 105247.2, "balAvg": 18454.92, "balLast": 809.59, "balOpen": 14688.2, "credits": 11, "debits": 47, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Apr-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-04-01", "stopPayments": 0, "totalCredit": 102768, "totalDebit": 116646.61, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 75717, "totalTransferOut": 51200.45 }, { "bal15": 5562.88, "bal25": 286.12, "bal5": 1317.59, "balAvg": 6587.85, "balLast": 3280.78, "balOpen": 809.59, "credits": 11, "debits": 53, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "May-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-05-01", "stopPayments": 0, "totalCredit": 94263.96, "totalDebit": 91792.77, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 73798, "totalTransferOut": 29873.3 }, { "bal15": 11088.28, "bal25": 3266.56, "bal5": 41851.01, "balAvg": 13453.27, "balLast": 2663.56, "balOpen": 3280.78, "credits": 11, "debits": 69, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jun-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-06-01", "stopPayments": 0, "totalCredit": 98163, "totalDebit": 98830.1, "totalEmiIssue": 0, "totalInvIncome": 202, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 85839, "totalTransferOut": 46364.38 }, { "bal15": 28315.97, "bal25": 18471.25, "bal5": 42909.76, "balAvg": 24188.61, "balLast": 15722.79, "balOpen": 2663.56, "credits": 8, "debits": 77, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jul-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-07-01", "stopPayments": 0, "totalCredit": 102986, "totalDebit": 89926.77, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 73554, "totalTransferOut": 40817.29 }, { "bal15": 9635.01, "bal25": 4360.01, "bal5": 7187.06, "balAvg": 12640.98, "balLast": 1191.57, "balOpen": 15722.79, "credits": 9, "debits": 76, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Aug-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-08-01", "stopPayments": 0, "totalCredit": 100425, "totalDebit": 114961.22, "totalEmiIssue": 0, "totalInvIncome": 270, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 88220, "totalTransferOut": 56005.09 }, { "bal15": 22882.02, "bal25": 13833.17, "bal5": 108131.46, "balAvg": 22640.73, "balLast": 12368.91, "balOpen": 1191.57, "credits": 21, "debits": 58, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Sep-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-09-01", "stopPayments": 0, "totalCredit": 128118.85, "totalDebit": 116941.51, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 99518, "totalTransferOut": 62835.65 }, { "bal15": 20051.83, "bal25": 10206.78, "bal5": 52677.51, "balAvg": 21607.39, "balLast": 8971.07, "balOpen": 12368.91, "credits": 34, "debits": 79, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Oct-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-10-01", "stopPayments": 0, "totalCredit": 152631.63, "totalDebit": 159009.47, "totalEmiIssue": 0, "totalInvIncome": 463, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 98715, "totalTransferOut": 79288.49 } ], "regularCredits": [ { "regularChangeDate": "2017-11-03", "regularChangeGroup": 1, "chqNo": "", "category": "other", "narration": "UPI-881012232765-PRITAM388@DBS-730714664976-UPI (Ref# 730714921890)", "amount": 33500, "balance": 70030.17 }, { "regularChangeDate": "2017-11-07", "regularChangeGroup": 1, "category": "Transfer from PRITAM388@DBS", "chqNo": "", "narration": "UPI-881012232765-PRITAM388@DBS-731113010074-UPI (Ref# 731113689162)", "amount": 15000, "balance": 35078.17 }, { "regularChangeDate": "2018-10-22", "regularChangeGroup": 1, "chqNo": "", "narration": "UPI-881012232765-PRITAM388@DBS-829512413244-UPI (Ref# 829512017179)", "amount": 14000, "category": "Transfer from PRITAM388@DBS", "balance": 30031.98 }, { "regularChangeDate": "2018-07-11", "regularChangeGroup": 2, "chqNo": "", "narration": "REIMBURSEMENT FOR MAY 18 (Ref# 807117470376)", "amount": 11256, "category": "Reimbursement", "balance": 28224.97 }, { "regularChangeDate": "2018-09-12", "regularChangeGroup": 2, "chqNo": "", "narration": "REIMBURSEMENT (Ref# 809122169526)", "amount": 12456, "category": "Reimbursement", "balance": 32038.46 }, { "regularChangeDate": "2018-10-10", "regularChangeGroup": 2, "chqNo": "", "narration": "REIMBURSEMENT (Ref# 810096072849)", "amount": 12000, "category": "Reimbursement", "balance": 59200.74 }, { "regularChangeDate": "2017-11-02", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR OCTOBER 17 (Ref# 711023778963)", "amount": 64485, "category": "Salary", "balance": 84977.17 }, { "regularChangeDate": "2017-12-05", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR NOVEMBER 17 (Ref# 712059608156)", "amount": 64910, "category": "Salary", "balance": 65631.75 }, { "regularChangeDate": "2018-01-04", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR DECEMBER 17 (Ref# 801042930730)", "amount": 69739, "category": "Salary", "balance": 74117.23 }, { "regularChangeDate": "2018-02-02", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR JANUARY 18 (Ref# 802020734946)", "amount": 72151, "category": "Salary", "balance": 74251.6 }, { "regularChangeDate": "2018-03-05", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR FEBRUARY 18 (Ref# 803055718782)", "amount": 75617, "category": "Salary", "balance": 75655.7 }, { "regularChangeDate": "2018-04-05", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR MARCH 18 (Ref# 804054032441)", "amount": 75717, "category": "Salary", "balance": 86216.2 }, { "regularChangeDate": "2018-05-07", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR APRIL 18 (Ref# 805070453471)", "amount": 73798, "category": "Salary", "balance": 75115.59 }, { "regularChangeDate": "2018-06-05", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR MAY 18 (Ref# 806044337506)", "amount": 85839, "category": "Salary", "balance": 86870.39 }, { "regularChangeDate": "2018-07-04", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR JUNE 18 (Ref# 807049989442)", "amount": 73554, "category": "Salary", "balance": 82291.45 }, { "regularChangeDate": "2018-08-06", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR JULY 18 (Ref# 808068385605)", "amount": 88220, "category": "Salary", "balance": 89067.46 }, { "regularChangeDate": "2018-09-05", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR AUGUST 18 (Ref# 809044090813)", "amount": 99518, "category": "Salary", "balance": 99881.46 }, { "regularChangeDate": "2018-10-05", "regularChangeGroup": 3, "chqNo": "", "narration": "SALARY FOR SEPTEMBER 18 (Ref# 810040668861)", "amount": 98715, "category": "Salary", "balance": 107986.56 } ], "eODBalances": [], "highValueDebitXns": [], "highValueCreditXns": [] }';
                // temp=PerfiosReportResponseHL.parse(json);
            genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             HL_Perfios_CallingAPI.callReport('12121');
             HL_Perfios_CallingAPI.callStatus('12121');
             HL_Perfios_CallingAPI.parseReportResponse(PerfiosReportResponseHL.parse(json),PFList,app.id,acc.id);
             
             test.stopTest();
         }
    //Bank_Account_Number__c   not matched 
     public static testMethod void method2(){
         Perfios__c perf =[select id,Bank_Account_Number__c from Perfios__c];
         perf.Bank_Account_Number__c='118515600000044';
         update perf;
         date todaysdate=system.today();
             string json='{ "customerInfo": { "name": "NALINA KRISHNAN S", "address": "123ede", "landline": "1234321", "mobile": "123454322", "email": "prashantsingh@gmail.com", "pan": "873hu38h39", "perfiosTransactionId": "KYX41538656269736", "customerTransactionId": "cac5d4f1-6d25-0384-ea68-d2880f545507", "bank": "Karur Vysya Bank, India", "instId": 50 }, "combinedMonthlyDetails": [ { "monthName": "Oct-17", "startDate": "2017-10-01" }, { "monthName": "Nov-17", "startDate": "2017-11-01" }, { "monthName": "Dec-17", "startDate": "2017-12-01" }, { "monthName": "Jan-18", "startDate": "2018-01-01" }, { "monthName": "Feb-18", "startDate": "2018-02-01" }, { "monthName": "Mar-18", "startDate": "2018-03-01" }, { "monthName": "Apr-18", "startDate": "2018-04-01" }, { "monthName": "May-18", "startDate": "2018-05-01" }, { "monthName": "Jun-18", "startDate": "2018-06-01" }, { "monthName": "Jul-18", "startDate": "2018-07-01" }, { "monthName": "Aug-18", "startDate": "2018-08-01" }, { "monthName": "Sep-18", "startDate": "2018-09-01" } ], "accountXns": [], "customUserInfo": {}, "AdditionalMonthlyDetails": [], "AdditionalSummaryDetails": { "avgBalanceOf3Months": 28109.21, "avgBalanceOf6Months": 30115.02, "avgBalanceOf12Months": 25692.19, "avgCreditsOf6Months": 9.17, "avgDebitsOf6Months": 27.17, "avgTotalCreditOf6Months": 114216.61, "avgTotalDebitOf6Months": 111812.62, "avgBalanceOf6MonthsToEMI": 30.12, "salaryContinuous": "Yes" }, "AdditionalForm26ASInfo": {}, "summaryInfo": { "instName": "Karur Vysya Bank, India", "accNo": [ { "bankAccNo": "1185156000000445" } ], "accType": "C", "fullMonthCount": 12, "total": { "bal15": 263119.09, "bal25": 139295.99, "bal5": 388491.59, "balAvg": 308306.23, "balLast": 438254.98, "balOpen": 431767.01, "credits": 109, "debits": 305, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "outwBounces": 0, "outwECSBounces": 0, "salaries": 12, "stopPayments": 0, "totalCredit": 1283008.68, "totalDebit": 1276520.71, "totalEmiIssue": 0, "totalInvIncome": 1324, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 476434.99, "totalTransferOut": 264160 }, "average": { "bal15": 21926.59, "bal25": 11608, "bal5": 32374.3, "balAvg": 25692.19, "balLast": 36521.25, "balOpen": 35980.58, "credits": 9, "debits": 25, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "stopPayments": 0, "totalCredit": 106917.39, "totalDebit": 106376.73, "totalEmiIssue": 0, "totalInvIncome": 110.33, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 39702.92, "totalTransferOut": 22013.33 }, "primaryAccNo": "1185156000000445" }, "monthlyDetails": [ { "bal15": 28226.87, "bal25": 19374.87, "bal5": 12588.87, "balAvg": 24290.46, "balLast": 37471.19, "balOpen": 27187.77, "credits": 9, "debits": 24, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Oct-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-10-01", "stopPayments": 0, "totalCredit": 79055.42, "totalDebit": 68772, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 42096.32, "totalTransferOut": 852 }, { "bal15": 18193.19, "bal25": 7413.19, "bal5": 30171.19, "balAvg": 22843.8, "balLast": 31651.93, "balOpen": 37471.19, "credits": 7, "debits": 23, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Nov-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-11-01", "stopPayments": 0, "totalCredit": 270438.74, "totalDebit": 276258, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 39238.74, "totalTransferOut": 25308 }, { "bal15": 10105.93, "bal25": 2455, "bal5": 25301.93, "balAvg": 15329.64, "balLast": 29305.74, "balOpen": 31651.93, "credits": 8, "debits": 22, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Dec-17", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2017-12-01", "stopPayments": 0, "totalCredit": 49115.81, "totalDebit": 51462, "totalEmiIssue": 0, "totalInvIncome": 265, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 38585.74, "totalTransferOut": 1216 }, { "bal15": 43428.43, "bal25": 26375.43, "bal5": 52739.43, "balAvg": 35229.09, "balLast": 22470.17, "balOpen": 29305.74, "credits": 16, "debits": 32, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jan-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-01-01", "stopPayments": 0, "totalCredit": 84361.43, "totalDebit": 91197, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 38797.74, "totalTransferOut": 22059 }, { "bal15": 10920.17, "bal25": 920.17, "bal5": 10470.17, "balAvg": 9391.1, "balLast": 6645.54, "balOpen": 22470.17, "credits": 3, "debits": 17, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Feb-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-02-01", "stopPayments": 0, "totalCredit": 22725.37, "totalDebit": 38550, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 15725.37, "totalTransferOut": 0 }, { "bal15": 29546.54, "bal25": 0.54, "bal5": 30956.54, "balAvg": 20532.05, "balLast": 19251.81, "balOpen": 6645.54, "credits": 11, "debits": 24, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Mar-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-03-01", "stopPayments": 0, "totalCredit": 92012.27, "totalDebit": 79406, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 36254.37, "totalTransferOut": 6240 }, { "bal15": 60425.81, "bal25": 23314.81, "bal5": 8545.81, "balAvg": 37198.47, "balLast": 66370.18, "balOpen": 19251.81, "credits": 7, "debits": 19, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Apr-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-04-01", "stopPayments": 0, "totalCredit": 111876.37, "totalDebit": 64758, "totalEmiIssue": 0, "totalInvIncome": 294, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 49405.37, "totalTransferOut": 30350 }, { "bal15": 7545.47, "bal25": 7561.47, "bal5": 56365.47, "balAvg": 29281.83, "balLast": 82822.86, "balOpen": 66370.18, "credits": 8, "debits": 30, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "May-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-05-01", "stopPayments": 0, "totalCredit": 109409.39, "totalDebit": 92956.71, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 44504.39, "totalTransferOut": 13449 }, { "bal15": 19329.86, "bal25": 265.61, "bal5": 64422.86, "balAvg": 29882.16, "balLast": 30618.98, "balOpen": 82822.86, "credits": 6, "debits": 35, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jun-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-06-01", "stopPayments": 0, "totalCredit": 52747.12, "totalDebit": 104951, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 43393.37, "totalTransferOut": 23486 }, { "bal15": 15086.48, "bal25": 15386.48, "bal5": 16096.98, "balAvg": 28507.99, "balLast": 41132.87, "balOpen": 30618.98, "credits": 5, "debits": 28, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Jul-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-07-01", "stopPayments": 0, "totalCredit": 231833.89, "totalDebit": 221320, "totalEmiIssue": 0, "totalInvIncome": 408, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 41866.39, "totalTransferOut": 137800 }, { "bal15": 9142.37, "bal25": 34120.45, "bal5": 58644.37, "balAvg": 38710.45, "balLast": 36837.97, "balOpen": 41132.87, "credits": 24, "debits": 27, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Aug-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-08-01", "stopPayments": 0, "totalCredit": 134475.1, "totalDebit": 138770, "totalEmiIssue": 0, "totalInvIncome": 0, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 42717.52, "totalTransferOut": 3400 }, { "bal15": 11167.97, "bal25": 2107.97, "bal5": 22187.97, "balAvg": 17109.2, "balLast": 33675.74, "balOpen": 36837.97, "credits": 5, "debits": 24, "emiIssues": 0, "inwBounces": 0, "inwECSBounces": 0, "monthName": "Sep-18", "outwBounces": 0, "outwECSBounces": 0, "salaries": 1, "startDate": "2018-09-01", "stopPayments": 0, "totalCredit": 44957.77, "totalDebit": 48120, "totalEmiIssue": 0, "totalInvIncome": 357, "totalInwECSBounce": 0, "totalOutwECSBounce": 0, "totalSalary": 43849.67, "totalTransferOut": 0 } ], "regularCredits": [ { "regularChangeDate": "2017-10-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Oct 2017 Salary 005360", "amount": 42096.32, "category": "Salary", "balance": 61471.19 }, { "regularChangeDate": "2017-11-28", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Nov 2017 Salary 005360", "amount": 39238.74, "category": "Salary", "balance": 46651.93 }, { "regularChangeDate": "2017-12-28", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Dec 2017 Salary 005360", "amount": 38585.74, "category": "Salary", "balance": 41040.74 }, { "regularChangeDate": "2018-01-29", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Jan 2018 Salary 005360", "amount": 38797.74, "category": "Salary", "balance": 45185.17 }, { "regularChangeDate": "2018-02-26", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Feb 2018 Salary 005360", "amount": 15725.37, "category": "Salary", "balance": 16645.54 }, { "regularChangeDate": "2018-03-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Mar 2018 Salary 005360", "amount": 36254.37, "category": "Salary", "balance": 36254.91 }, { "regularChangeDate": "2018-04-26", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Apr 2018 Salary 005360", "amount": 49405.37, "category": "Salary", "balance": 72720.18 }, { "regularChangeDate": "2018-05-29", "regularChangeGroup": 1, "chqNo": "", "narration": "NT May 2018 Salary 005360", "amount": 44504.39, "category": "Salary", "balance": 81129.86 }, { "regularChangeDate": "2018-06-28", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Jun 2018 Salary 005360", "amount": 43393.37, "category": "Salary", "balance": 43658.98 }, { "regularChangeDate": "2018-07-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Jul 2018 Salary 005360", "amount": 41866.39, "category": "Salary", "balance": 57252.87 }, { "regularChangeDate": "2018-08-29", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Aug 2018 Salary 005360", "amount": 42717.52, "category": "Salary", "balance": 76837.97 }, { "regularChangeDate": "2018-09-27", "regularChangeGroup": 1, "chqNo": "", "narration": "NT Sep 2018 Salary 005360", "amount": 43849.67, "category": "Salary", "balance": 45957.64 } ], "eODBalances": [], "highValueDebitXns": [], "highValueCreditXns": [] }';      
            genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             HL_Perfios_CallingAPI.callReport('12121');
             HL_Perfios_CallingAPI.callStatus('12121');
             HL_Perfios_CallingAPI.parseReportResponse(PerfiosReportResponseHL.parse(json),PFList,app.id,acc.id);
             
             test.stopTest();
         }
    
      public static testMethod void method3(){
         Perfios__c perf =[select id,Bank_Account_Number__c from Perfios__c];
         perf.Bank_Account_Number__c='118515600000044';
         update perf;
         date todaysdate=system.today();
             string json='{ "itrvDetails": [ { "acknowledgementNumber": "831654340280617", "assessmentYear": "2017-18", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "NO 504, RAM NAGAR KVB STAFF QUARTERS OFF SALEM BYEPASS ROAD VENGAMEDU POST KARUR TAMILNADU 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "227088", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1185715", "interestPayable": "0", "netTaxPayable": "120228", "refund": "200", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "120430", "totalTaxPaid": "120430" }, "totalIncome": "958630", "totalTaxAndInterestPayable": "120228" } }, { "acknowledgementNumber": "198469860140616", "assessmentYear": "2016-17", "dateOfSubmission": "2016-06-14", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "OFF SALEM BYEPASS KVB STAFF QUARTERS KARUR 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "237357", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1585927", "interestPayable": "0", "netTaxPayable": "0", "refund": "8010", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "244463", "totalTaxPaid": "244463" }, "totalIncome": "1348570", "totalTaxAndInterestPayable": "236458" } } ], "IT-R": {} }';
          
            genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             HL_Perfios_CallingAPI.callReport('12121');
             HL_Perfios_CallingAPI.callStatus('12121');
             HL_Perfios_CallingAPI.ParseITRResponse(ITRResponseHL.parse(json),acc.id,app.id);
             
             test.stopTest();
         }
    
     public static testMethod void method4(){
         Perfios__c perf =[select id,Bank_Account_Number__c from Perfios__c];
         perf.Bank_Account_Number__c='118515600000044';
         update perf;
         date todaysdate=system.today();
          //   string json='{ "itrvDetails": [ { "acknowledgementNumber": "831654340280617", "assessmentYear": "2017-18", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2017-18", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "NO 504, RAM NAGAR KVB STAFF QUARTERS OFF SALEM BYEPASS ROAD VENGAMEDU POST KARUR TAMILNADU 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "227088", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1185715", "interestPayable": "0", "netTaxPayable": "120228", "refund": "200", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "120430", "totalTaxPaid": "120430" }, "totalIncome": "958630", "totalTaxAndInterestPayable": "120228" } }, { "acknowledgementNumber": "198469860140616", "assessmentYear": "2016-17", "dateOfSubmission": "2016-06-14", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "OFF SALEM BYEPASS KVB STAFF QUARTERS KARUR 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "237357", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1585927", "interestPayable": "0", "netTaxPayable": "0", "refund": "8010", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "244463", "totalTaxPaid": "244463" }, "totalIncome": "1348570", "totalTaxAndInterestPayable": "236458" } } ], "IT-R": {} }';
      
   String json='{ "itrvDetails": [ { "acknowledgementNumber": "965229890310718", "assessmentYear": "2018-19", "dateOfSubmission": "2018-07-31", "designationOfAO": "WARD 2,TIRUR", "eFilingStatus": "Successfully e-Verified", "financialYear": "2017-18", "formNumber": "ITR-1", "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "162000", "exemptIncome": { "agriculture": "0", "others": "0" }, "grossTotalIncome": "1103463", "interestPayable": "0", "netTaxPayable": "103816", "refund": "0", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "103820", "totalTaxPaid": "103820" }, "totalIncome": "941460", "totalTaxAndInterestPayable": "0" }, "originalOrRevised": "ORIGINAL", "personalInfo": "" }, { "acknowledgementNumber": "511687480270318", "assessmentYear": "2017-18", "dateOfSubmission": "2018-03-27", "designationOfAO": "WARD 2,TIRUR", "eFilingStatus": "ITR Processed", "financialYear": "2016-17", "formNumber": "ITR-1", "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "159631", "exemptIncome": { "agriculture": "0", "others": "0" }, "grossTotalIncome": "666204", "interestPayable": "0", "netTaxPayable": "27103", "refund": "0", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "27100", "totalTaxPaid": "27100" }, "totalIncome": "506570", "totalTaxAndInterestPayable": "27103" }, "originalOrRevised": "ORIGINAL", "personalInfo": "" } ], "itrDetails": { "itr1": [ { "ay": "2018-19", "filingStatus": null, "fy": "2017-18", "itr1IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": "78960", "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr1TaxComputation": null, "personalInfo": null, "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1" }, { "ay": "2017-18", "filingStatus": null, "fy": "2016-17", "itr1IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": 7890, "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr1TaxComputation": null, "personalInfo": "", "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1" } ], "itr2": [ { "fy": "2016-17", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } } ], "itr3": [ { "ay": "2018-19", "filingStatus": null, "fy": "2017-18", "itr3IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": "78960", "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr3TaxComputation": null, "personalInfo": null, "refund": null, "taxPaid": null, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1", "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "ay": "2017-18", "filingStatus": null, "fy": "2016-17", "itr3IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": 7990, "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr3TaxComputation": null, "personalInfo": "", "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1", "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "ay": "2017-18", "filingStatus": null, "fy": "2016-17", "itr3IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": 7990, "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr3TaxComputation": null, "personalInfo": "", "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1", "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } } ], "itr4": [ { "fy": "2017-18", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "fy": "2016-17", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } } ] } }';
         genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             HL_Perfios_CallingAPI.callReport('12121');
             HL_Perfios_CallingAPI.callStatus('12121');
             HL_Perfios_CallingAPI.ParseITRResponse(ITRResponseHL.parse(json),acc.id,app.id);
             
             test.stopTest();
         }
     public static testMethod void method5(){
         Perfios__c perf =[select id,Bank_Account_Number__c from Perfios__c];
         perf.Bank_Account_Number__c='118515600000044';
         update perf;
         date todaysdate=system.today();
             string json='{ "itrDetails": { "itr1": [ { "fy": "2016-17" } ], "itr2": [ { "fy": "2016-17", "partBTI": { "capGain": { "totalCapGains": "12" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14320", "dividendGross": "0" } } } ], "itr3": [ { "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "100", "aopboiSharInc": "200" } } }, "partBTI": { "capGain": { "totalCapGains": "30" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "200", "dividendGross": "300" } } } ], "itr4": [ { "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "100", "aopboiSharInc": "123" } } }, "partBTI": { "capGain": { "totalCapGains": "300" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "4352", "dividendGross": "322" } } } ] }, "itrvDetails": [ { "acknowledgementNumber": "831654340280617", "assessmentYear": "2017-18", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "NO 504, RAM NAGAR KVB STAFF QUARTERS OFF SALEM BYEPASS ROAD VENGAMEDU POST KARUR TAMILNADU 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "227088", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1185715", "interestPayable": "0", "netTaxPayable": "120228", "refund": "200", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "120430", "totalTaxPaid": "120430" }, "totalIncome": "958630", "totalTaxAndInterestPayable": "120228" } }, { "acknowledgementNumber": "198469860140616", "assessmentYear": "2016-17", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "OFF SALEM BYEPASS KVB STAFF QUARTERS KARUR 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "237357", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1585927", "interestPayable": "0", "netTaxPayable": "0", "refund": "8010", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "244463", "totalTaxPaid": "244463" }, "totalIncome": "1348570", "totalTaxAndInterestPayable": "236458" } } ] }';
         
            genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             HL_Perfios_CallingAPI.callReport('12121');
             HL_Perfios_CallingAPI.callStatus('12121');
             HL_Perfios_CallingAPI.ParseITRResponse(ITRResponseHL.parse(json),acc.id,app.id);
             
             test.stopTest();
         }
    //for itr4 record type!=LAP
      public static testMethod void method6(){
                          Id recordidapp = Schema.SObjectType.genesis__Applications__c.getRecordTypeInfosByName().get(Constants.PERSONALLOAN).getRecordTypeId();

                  genesis__Applications__c newApp = [select id,RecordTypeId from genesis__Applications__c];
          newApp.RecordTypeId=recordidapp;
          update newApp;
          

         Perfios__c perf =[select id,Bank_Account_Number__c from Perfios__c];
         perf.Bank_Account_Number__c='118515600000044';
         update perf;
         date todaysdate=system.today();
             string jsonitr='{ "itrDetails": { "itr1": [ { "fy": "2016-17" } ], "itr2": [ { "fy": "2016-17", "partBTI": { "capGain": { "totalCapGains": "12" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14320", "dividendGross": "0" } } } ], "itr3": [ { "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "100", "aopboiSharInc": "200" } } }, "partBTI": { "capGain": { "totalCapGains": "30" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "200", "dividendGross": "300" } } } ], "itr4": [ { "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "100", "aopboiSharInc": "123" } } }, "partBTI": { "capGain": { "totalCapGains": "300" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "4352", "dividendGross": "322" } } } ] }, "itrvDetails": [ { "acknowledgementNumber": "831654340280617", "assessmentYear": "2017-18", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "NO 504, RAM NAGAR KVB STAFF QUARTERS OFF SALEM BYEPASS ROAD VENGAMEDU POST KARUR TAMILNADU 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "227088", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1185715", "interestPayable": "0", "netTaxPayable": "120228", "refund": "200", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "120430", "totalTaxPaid": "120430" }, "totalIncome": "958630", "totalTaxAndInterestPayable": "120228" } }, { "acknowledgementNumber": "198469860140616", "assessmentYear": "2016-17", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "OFF SALEM BYEPASS KVB STAFF QUARTERS KARUR 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "237357", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1585927", "interestPayable": "0", "netTaxPayable": "0", "refund": "8010", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "244463", "totalTaxPaid": "244463" }, "totalIncome": "1348570", "totalTaxAndInterestPayable": "236458" } } ] }';
           String jsonform26=		'{'+
		'  "form26ASDetails": {'+
		'    "form26asInfo": ['+
		'      {'+
		'        "assessmentYear": "2019-20",'+
		'        "financialYear": "2018-19",'+
		'        "tdsList": ['+
		'          {'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-04-30",'+
		'            "amount": "73579",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "1409"'+
		'          },'+
		'          {'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-05-31",'+
		'            "amount": "73667",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "1424"'+
		'          },'+
		'          {'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-06-30",'+
		'            "amount": "71073",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "1802"'+
		'          },'+
		'          {'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-07-31",'+
		'            "amount": "75825",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "1797"'+
		'          },'+
		'          {'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-08-31",'+
		'            "amount": "76369",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "890"'+
		'          },'+
		'          {'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-09-30",'+
		'            "amount": "77020",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "948"'+
		'          }'+
		'        ],'+
		'        "nonTdsList": []'+
		'      }'+
		'    ],'+
		'    "personalInfo": {'+
		'      "address": "RAM NIVAS, MANALODY, NILAMBUR, MALAPPURAM, KERALA, 679329",'+
		'      "dob": "11/12/1984",'+
		'      "name": "THERIERI RAHUL",'+
		'      "pan": "ALPPR7887J",'+
		'      "panStatus": "Active"'+
		'    }'+
		'  }'+
		'}'+
		'';
            genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             HL_Perfios_CallingAPI.callReport('12121');
             HL_Perfios_CallingAPI.callStatus('12121');
             HL_Perfios_CallingAPI.ParseITRResponse(ITRResponseHL.parse(jsonitr),acc.id,app.id);
             HL_Perfios_CallingAPI.ParseForm26ASchange(Form26asResponse.parse(jsonform26),acc.id,app.id);

             test.stopTest();
         }

     
    //for itr4 record type!=LAP
      public static testMethod void method7(){
                          Id recordidapp = Schema.SObjectType.genesis__Applications__c.getRecordTypeInfosByName().get(Constants.PERSONALLOAN).getRecordTypeId();

                  genesis__Applications__c newApp = [select id,RecordTypeId from genesis__Applications__c];
          newApp.RecordTypeId=recordidapp;
          update newApp;
          

         Perfios__c perf =[select id,Bank_Account_Number__c from Perfios__c];
         perf.Bank_Account_Number__c='118515600000044';
         update perf;
         date todaysdate=system.today();
             string jsonitr='{ "itrDetails": { "itr1": [ { "fy": "2016-17" } ], "itr2": [ { "fy": "2016-17", "partBTI": { "capGain": { "totalCapGains": "12" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14320", "dividendGross": "0" } } } ], "itr3": [ { "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "100", "aopboiSharInc": "200" } } }, "partBTI": { "capGain": { "totalCapGains": "30" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "200", "dividendGross": "300" } } } ], "itr4": [ { "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "100", "aopboiSharInc": "123" } } }, "partBTI": { "capGain": { "totalCapGains": "300" } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "4352", "dividendGross": "322" } } } ] }, "itrvDetails": [ { "acknowledgementNumber": "831654340280617", "assessmentYear": "2017-18", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "NO 504, RAM NAGAR KVB STAFF QUARTERS OFF SALEM BYEPASS ROAD VENGAMEDU POST KARUR TAMILNADU 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "227088", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1185715", "interestPayable": "0", "netTaxPayable": "120228", "refund": "200", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "120430", "totalTaxPaid": "120430" }, "totalIncome": "958630", "totalTaxAndInterestPayable": "120228" } }, { "acknowledgementNumber": "198469860140616", "assessmentYear": "2016-17", "dateOfSubmission": "2017-06-28", "designationOfAO": "WARD 2 KARUR", "financialYear": "2016-17", "formNumber": "ITR-1", "originalOrRevised": "ORIGINAL", "personalInfo": { "name": "KRISHNA KUMAR TADIPARTI", "address": "OFF SALEM BYEPASS KVB STAFF QUARTERS KARUR 639006", "adhaarNumber": "NA", "pan": "ABTPT6730E", "status": "Individual" }, "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "237357", "exemptIncome": { "agriculture": "425000", "others": "0" }, "grossTotalIncome": "1585927", "interestPayable": "0", "netTaxPayable": "0", "refund": "8010", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "244463", "totalTaxPaid": "244463" }, "totalIncome": "1348570", "totalTaxAndInterestPayable": "236458" } } ] }';
          String jsonform26=		'{'+
		'  "form26ASDetails": {'+
		'    "form26asInfo": ['+
		'      {'+
		'        "assessmentYear": "2019-20",'+
		'        "financialYear": "2018-19",'+
		'        "tdsList": ['+
		'         '+
		'          {'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-09-30",'+
		'            "amount": "77020",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "948"'+
		'          }'+
		'        ],'+
		'        "nonTdsList": [{'+
		'            "section": "192",'+
		'            "deductor": "THE KARUR VYSYA BANK LTD CENTRAL OFFICE",'+
		'            "tdsDate": "2018-08-31",'+
		'            "amount": "76369",'+
		'            "tan": "CHET04666E",'+
		'            "taxDeducted": "890"'+
		'          }'+
		'          ]'+
		'      }'+
		'    ],'+
		'    "personalInfo": {'+
		'      "address": "RAM NIVAS, MANALODY, NILAMBUR, MALAPPURAM, KERALA, 679329",'+
		'      "dob": "11/12/1984",'+
		'      "name": "THERIERI RAHUL",'+
		'      "pan": "ALPPR7887J",'+
		'      "panStatus": "Active"'+
		'    }'+
		'  }'+
		'}'+
		'';
            genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             
             HL_Perfios_CallingAPI.ParseForm26ASchange(Form26asResponse.parse(jsonform26),acc.id,app.id);

             test.stopTest();
         }
     public static testMethod void method8(){
  String json='{ "PerfiosStatusReportHL": { "Status": { "files": "ppp", "parts": "1", "processing": "completed", "txnId": "ae348f79-d0e8-bddf-c9ff-2edca11f2496", "Part": { "errorCode": "E_NO_ERROR", "perfiosTransactionId": "AE241522146923157", "reason": "NA", "status": "success" } } } }';
         
         PerfiosStatusReportHL pp=PerfiosStatusReportHL.parse(json);
         System.debug('pp'+pp);
         HL_Perfios_CallingAPI.parseStatusResponse(pp);
     }
     public static testMethod void method9(){
         Perfios__c perf =[select id,Bank_Account_Number__c from Perfios__c];
         perf.Bank_Account_Number__c='118515600000044';
         update perf;
         date todaysdate=system.today();
   String json='{ "itrvDetails": [ { "acknowledgementNumber": "965229890310718", "assessmentYear": "2018-19", "dateOfSubmission": "2018-07-31", "designationOfAO": "WARD 2,TIRUR", "eFilingStatus": "Successfully e-Verified", "financialYear": "2017-18", "formNumber": "ITR-1", "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "162000", "exemptIncome": { "agriculture": "0", "others": "0" }, "grossTotalIncome": "1103463", "interestPayable": "0", "netTaxPayable": "103816", "refund": "0", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "103820", "totalTaxPaid": "103820" }, "totalIncome": "941460", "totalTaxAndInterestPayable": "0" }, "originalOrRevised": "ORIGINAL", "personalInfo": "" }, { "acknowledgementNumber": "511687480270318", "assessmentYear": "2017-18", "dateOfSubmission": "2018-03-27", "designationOfAO": "WARD 2,TIRUR", "eFilingStatus": "ITR Processed", "financialYear": "2016-17", "formNumber": "ITR-1", "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "159631", "exemptIncome": { "agriculture": "0", "others": "0" }, "grossTotalIncome": "666204", "interestPayable": "0", "netTaxPayable": "27103", "refund": "0", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "27100", "totalTaxPaid": "27100" }, "totalIncome": "506570", "totalTaxAndInterestPayable": "27103" }, "originalOrRevised": "ORIGINAL", "personalInfo": "" }, { "acknowledgementNumber": "511687480270318", "assessmentYear": "2017-18", "dateOfSubmission": "2018-03-27", "designationOfAO": "WARD 2,TIRUR", "eFilingStatus": "ITR Processed", "financialYear": "2016-17", "formNumber": "ITR-1", "incomeDetail": { "currentYearLoss": "0", "deductionsUnderChapter6A": "159631", "exemptIncome": { "agriculture": "0", "others": "0" }, "grossTotalIncome": "666204", "interestPayable": "0", "netTaxPayable": "27103", "refund": "0", "taxPayable": "0", "taxesPaid": { "advanceTax": "0", "selfAssessmentTax": "0", "tcs": "0", "tds": "27100", "totalTaxPaid": "27100" }, "totalIncome": "506570", "totalTaxAndInterestPayable": "27103" }, "originalOrRevised": "ORIGINAL", "personalInfo": "" } ], "itrDetails": { "itr1": [ { "ay": "2018-19", "filingStatus": null, "fy": "2017-18", "itr1IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": "78960", "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr1TaxComputation": null, "personalInfo": null, "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1" }, { "ay": "2017-18", "filingStatus": null, "fy": "2016-17", "itr1IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": 7890, "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr1TaxComputation": null, "personalInfo": "", "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1" }, { "ay": "2017-18", "filingStatus": null, "fy": "2016-17", "itr1IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": 7890, "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr1TaxComputation": null, "personalInfo": "", "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1" } ], "itr2": [ { "fy": "2016-17", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "fy": "2016-17", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "fy": "2016-17", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } } ], "itr3": [ { "ay": "2018-19", "filingStatus": null, "fy": "2017-18", "itr3IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": "78960", "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr3TaxComputation": null, "personalInfo": null, "refund": null, "taxPaid": null, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1", "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "ay": "2017-18", "filingStatus": null, "fy": "2016-17", "itr3IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": 7990, "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr3TaxComputation": null, "personalInfo": "", "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1", "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "ay": "2017-18", "filingStatus": null, "fy": "2016-17", "itr3IncomeDeductions": { "deductUndChapVIA": { "section80C": "150000", "section80CCC": "89", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "159631" }, "grossTotIncome": "666204", "incomeFromSal": "941204", "incomeOthSrc": 7990, "totalIncome": "506570", "totalIncomeOfHP": "-275000", "usrDeductUndChapVIA": { "section80C": "167078", "section80CCC": "0", "section80CCDEmployeeOrSE": "0", "section80CCDEmployer": "0", "section80CCG": "0", "section80D": "9631", "section80DD": "0", "section80DDB": "0", "section80E": "0", "section80G": "0", "section80GG": "0", "section80GGA": "0", "section80GGC": "0", "section80IA": "0", "section80IAB": "0", "section80IB": "0", "section80IC": "0", "section80ID": "0", "section80JJA": "0", "section80QQB": "0", "section80RRB": "0", "section80TTA": "0", "section80U": "0", "totalChapVIADeductions": "176709" } }, "itr3TaxComputation": null, "personalInfo": "", "refund": null, "taxPaid": null, "tdSonOthThanSals": null, "tdSonSalaries": null, "type": "ITR1", "itr3ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } } ], "itr4": [ { "fy": "2017-18", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "fy": "2016-17", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } }, { "fy": "2016-17", "itr4ScheduleBP": { "businessIncOthThanSpec": { "incCredPL": { "firmShareInc": "123", "aopboiSharInc": 1000 } } }, "partBTI": { "capGain": { "totalCapGains": 1900 } }, "scheduleOS": { "incOthThanOwnRaceHorse": { "interestGross": "14502", "dividendGross": "0" } } } ] } }';       
       
         genesis__applications__c app=[select id from genesis__applications__c limit 1];
             Account acc=[select id from Account limit 1];
            List<Perfios__c> PFList=new List<Perfios__c>([select id,Bank_Account_Number__c from Perfios__c]);
            Test.setMock(HttpCalloutMock.class, new MockHttpResponse());
             test.startTest();
             HL_Perfios_CallingAPI.callReport('12121');
             HL_Perfios_CallingAPI.callStatus('12121');
             HL_Perfios_CallingAPI.ParseITRResponse(ITRResponseHL.parse(json),acc.id,app.id);
             
             test.stopTest();
         }

}